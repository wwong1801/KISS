<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KISS Review — Light</title>
<style>
  :root{
    --bg:#f6f7fb;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#2563eb;
    --danger:#ef4444;
    --ok:#10b981;
    --glass: rgba(0,0,0,0.04);
    font-family: Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#0f172a}
  .app{max-width:1100px;margin:28px auto;padding:18px;display:grid;grid-template-columns:360px 1fr;gap:20px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px}
  .title{font-weight:700;font-size:20px}
  .sub{color:var(--muted);font-size:13px}
  .left-card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px var(--glass)}
  .right-card{background:var(--card);border-radius:12px;padding:10px;box-shadow:0 6px 18px var(--glass);min-height:540px;display:flex;flex-direction:column}
  .list-item{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;margin-bottom:10px;background:linear-gradient(180deg, rgba(37,99,235,0.04), transparent)}
  .list-left{display:flex;gap:12px;align-items:center}
  .icon{width:42px;height:42px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#eef2ff,#e0e7ff);font-weight:600;color:#1e293b}
  .meta{font-size:12px;color:var(--muted)}
  .btn{padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
  .fab{position:fixed;right:26px;bottom:26px;width:56px;height:56px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-size:26px;border:none;box-shadow:0 10px 30px rgba(37,99,235,0.18);cursor:pointer}
  .filters{display:flex;gap:8px;margin:10px 0;flex-wrap:wrap}
  .chip{background:#fff;padding:8px 10px;border-radius:999px;border:1px solid rgba(15,23,42,0.06);font-size:13px;cursor:pointer}
  .chip.active{background:rgba(37,99,235,0.08);border-color:rgba(37,99,235,0.16)}
  .grid-2x2{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:10px;flex:1;padding:8px}
  .quad{background:#fbfdff;border-radius:10px;padding:12px;box-shadow:inset 0 -1px 0 rgba(15,23,42,0.02);min-height:160px;display:flex;flex-direction:column}
  .quad h4{margin:0;font-size:13px}
  .quad .hint{color:var(--muted);font-size:13px;margin-top:8px}
  textarea{width:100%;height:100%;border:1px dashed rgba(15,23,42,0.06);padding:10px;border-radius:8px;resize:none;background:transparent;font-family:inherit}
  .quad-row{display:flex;gap:8px;align-items:center}
  .quad .badge{padding:6px 8px;border-radius:8px;font-weight:600;font-size:12px}
  .badge.keep{background:rgba(16,185,129,0.12);color:var(--ok)}
  .badge.improve{background:rgba(245,158,11,0.08);color:#b45309}
  .badge.start{background:rgba(37,99,235,0.08);color:var(--accent)}
  .badge.stop{background:rgba(239,68,68,0.08);color:var(--danger)}
  .actions{display:flex;gap:8px;justify-content:flex-end;padding-top:8px}
  .small{font-size:13px;color:var(--muted)}
  .entry-controls{display:flex;gap:6px}
  .btn-ghost{background:transparent;border:1px solid rgba(15,23,42,0.06);padding:8px 10px;border-radius:8px;cursor:pointer}
  .panel-header{display:flex;align-items:center;justify-content:space-between;padding:8px 12px}
  .search{width:100%;padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)}
  footer{grid-column:1/-1;text-align:center;color:var(--muted);font-size:13px;margin-top:12px}
  @media (max-width:900px){
    .app{grid-template-columns:1fr; padding:12px}
    .right-card{min-height:420px}
  }
</style>
</head>
<body>
  <div class="app">
    <div>
      <header style="display:flex;align-items:center;justify-content:space-between">
        <div>
          <div class="title">KISS App</div>
          <div class="sub">Quick personal reviews</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn-ghost" id="exportBtn">Export</button>
          <label class="btn-ghost" style="cursor:pointer;padding:8px 10px;">
            Import
            <input id="importFile" type="file" accept="application/json" style="display:none">
          </label>
        </div>
      </header>

      <div class="left-card" style="margin-top:12px">
        <input id="search" class="search" placeholder="Search reviews or goal..." />
        <div class="filters" style="margin-top:10px">
          <div class="chip active" data-filter="all">All</div>
          <div class="chip" data-filter="Keep">Keep</div>
          <div class="chip" data-filter="Improve">Improve</div>
          <div class="chip" data-filter="Start">Start</div>
          <div class="chip" data-filter="Stop">Stop</div>
          <div class="chip" data-filter="Principle">Principle</div>
        </div>

        <div id="list" style="margin-top:8px"></div>

        <div style="margin-top:8px" class="small">Tip: Click an item to edit. Use + to add new.</div>

        <!-- preview of uploaded mockup -->
        <div style="margin-top:12px;text-align:center">
          <img src="/mnt/data/f12a98b8-15fb-492a-8a1b-059b662745fe.png" alt="mockup" style="max-width:100%;border-radius:8px;border:1px solid rgba(15,23,42,0.03)">
          <div class="small" style="margin-top:6px">Your mockup (for reference)</div>
        </div>
      </div>
    </div>

    <div class="right-card">
      <div class="panel-header">
        <div>
          <strong id="panelTitle">Review: New</strong>
          <div class="small" id="panelDate">—</div>
        </div>
        <div class="entry-controls">
          <button class="btn-ghost" id="clearBtn">Clear</button>
          <button class="btn" id="saveBtn">Save</button>
        </div>
      </div>

      <div style="padding:8px">
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <input id="goalInput" placeholder="Goal (e.g., Exercise, Lose Weight)" style="flex:1;padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)">
          <input id="dateInput" type="date" style="padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)" />
        </div>

        <div class="grid-2x2">
          <div class="quad">
            <div class="quad-row"><div class="badge keep">KEEP</div><div style="flex:1"></div></div>
            <textarea id="keep" placeholder="What's working..." ></textarea>
          </div>

          <div class="quad">
            <div class="quad-row"><div class="badge improve">IMPROVE</div><div style="flex:1"></div></div>
            <textarea id="improve" placeholder="What could be better..."></textarea>
          </div>

          <div class="quad">
            <div class="quad-row"><div class="badge start">START</div><div style="flex:1"></div></div>
            <textarea id="start" placeholder="What to begin..."></textarea>
          </div>

          <div class="quad">
            <div class="quad-row"><div class="badge stop">STOP</div><div style="flex:1"></div></div>
            <textarea id="stop" placeholder="What to cease..."></textarea>
          </div>
        </div>

        <div class="actions" style="margin-top:10px">
          <button class="btn-ghost" id="deleteBtn" style="display:none;background:transparent;border:1px solid rgba(239,68,68,0.08);color:var(--danger)">Delete</button>
          <div style="flex:1"></div>
          <div class="small" id="statusText"></div>
        </div>
      </div>
    </div>

    <footer>Built quick — local only. Export/Import included.</footer>
  </div>

<script>
(function(){
  const STORAGE_KEY = 'kiss_reviews_v2';
  let entries = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  let editingId = null;

  const listEl = document.getElementById('list');
  const goalInput = document.getElementById('goalInput');
  const dateInput = document.getElementById('dateInput');
  const keepEl = document.getElementById('keep');
  const improveEl = document.getElementById('improve');
  const startEl = document.getElementById('start');
  const stopEl = document.getElementById('stop');
  const panelTitle = document.getElementById('panelTitle');
  const panelDate = document.getElementById('panelDate');
  const saveBtn = document.getElementById('saveBtn');
  const clearBtn = document.getElementById('clearBtn');
  const deleteBtn = document.getElementById('deleteBtn');
  const statusText = document.getElementById('statusText');
  const search = document.getElementById('search');
  const chips = Array.from(document.querySelectorAll('.chip'));
  const exportBtn = document.getElementById('exportBtn');
  const importFile = document.getElementById('importFile');

  function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,6) }

  function saveToStorage(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
  }

  function setNowDateInput(){
    const d = new Date();
    dateInput.value = d.toISOString().slice(0,10);
  }

  function clearForm(){
    editingId = null;
    goalInput.value = '';
    keepEl.value = '';
    improveEl.value = '';
    startEl.value = '';
    stopEl.value = '';
    setNowDateInput();
    panelTitle.textContent = 'Review: New';
    panelDate.textContent = '';
    deleteBtn.style.display = 'none';
    statusText.textContent = '';
  }

  function renderList(filter='all', q=''){
    listEl.innerHTML = '';
    let out = entries.slice().sort((a,b)=> b.updatedAt - a.updatedAt);
    if(filter !== 'all') out = out.filter(e => (e.tag && e.tag === filter) || (e.keepTag && e.keepTag === filter) || e.goal === filter);
    if(q) {
      const qq = q.toLowerCase();
      out = out.filter(e => (e.goal + ' ' + e.keep + ' ' + e.improve + ' ' + e.start + ' ' + e.stop).toLowerCase().includes(qq));
    }
    if(out.length === 0){
      listEl.innerHTML = '<div class="small" style="padding:8px;color:var(--muted)">No reviews yet.</div>';
      return;
    }
    out.forEach(e => {
      const item = document.createElement('div');
      item.className = 'list-item';
      item.innerHTML = \`
        <div class="list-left">
          <div class="icon">\${(e.goal||'').slice(0,2).toUpperCase()}</div>
          <div>
            <div style="font-weight:600">\${e.goal || '(No goal)'}</div>
            <div class="meta">Last modified: \${new Date(e.updatedAt).toLocaleString()}</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <div class="meta">\${e.date}</div>
          <div style="width:6px"></div>
          <button class="btn-ghost" data-id="\${e.id}" title="Edit">Edit</button>
        </div>
      \`;
      listEl.appendChild(item);
      item.querySelector('button').addEventListener('click', ()=> loadForEdit(e.id));
    });
  }

  function loadForEdit(id){
    const e = entries.find(x => x.id === id);
    if(!e) return;
    editingId = id;
    goalInput.value = e.goal;
    dateInput.value = e.date || new Date(e.updatedAt).toISOString().slice(0,10);
    keepEl.value = e.keep || '';
    improveEl.value = e.improve || '';
    startEl.value = e.start || '';
    stopEl.value = e.stop || '';
    panelTitle.textContent = 'Review: ' + (e.goal || 'Edit');
    panelDate.textContent = e.date ? ('Date: ' + e.date) : '';
    deleteBtn.style.display = 'inline-block';
    statusText.textContent = 'Editing saved entry';
  }

  function saveEntry(){
    const goal = goalInput.value.trim();
    const date = dateInput.value || new Date().toISOString().slice(0,10);
    const keep = keepEl.value.trim();
    const improve = improveEl.value.trim();
    const start = startEl.value.trim();
    const stop = stopEl.value.trim();
    if(!goal){
      alert('Please enter a goal (e.g., Exercise, Lose Weight).');
      return;
    }
    const now = Date.now();
    if(editingId){
      const idx = entries.findIndex(x=>x.id===editingId);
      if(idx>=0){
        entries[idx] = {...entries[idx], goal,date,keep,improve,start,stop,updatedAt:now};
      }
    } else {
      const item = { id: uid(), goal, date, keep, improve, start, stop, createdAt:now, updatedAt: now };
      entries.push(item);
      editingId = item.id;
    }
    saveToStorage();
    renderList(activeFilter(), search.value.trim());
    statusText.textContent = 'Saved ' + new Date().toLocaleString();
    deleteBtn.style.display = 'inline-block';
  }

  function deleteEntry(){
    if(!editingId) return;
    if(!confirm('Delete this review?')) return;
    entries = entries.filter(x => x.id !== editingId);
    saveToStorage();
    clearForm();
    renderList(activeFilter(), search.value.trim());
  }

  function activeFilter(){
    const a = document.querySelector('.chip.active');
    return a ? a.dataset.filter : 'all';
  }

  // initial setup
  setNowDateInput();
  renderList();

  // listeners
  saveBtn.addEventListener('click', saveEntry);
  clearBtn.addEventListener('click', clearForm);
  deleteBtn.addEventListener('click', deleteEntry);

  search.addEventListener('input', ()=> renderList(activeFilter(), search.value.trim()));

  chips.forEach(c => {
    c.addEventListener('click', ()=> {
      chips.forEach(x=>x.classList.remove('active'));
      c.classList.add('active');
      renderList(c.dataset.filter, search.value.trim());
    });
  });

  exportBtn.addEventListener('click', ()=>{
    const data = JSON.stringify(entries, null, 2);
    const blob = new Blob([data], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'kiss_reviews.json';
    a.click();
    URL.revokeObjectURL(url);
  });

  importFile.addEventListener('change', (ev)=>{
    const f = ev.target.files[0];
    if(!f) return;
    const r = new FileReader();
    r.onload = () => {
      try {
        const imported = JSON.parse(r.result);
        if(!Array.isArray(imported)) throw new Error('Not array');
        // prepend imported
        entries = imported.concat(entries);
        saveToStorage();
        renderList(activeFilter(), search.value.trim());
        alert('Imported ' + imported.length + ' entries.');
      } catch (err){
        alert('Invalid file: ' + err.message);
      }
    };
    r.readAsText(f);
  });

  // expose for debugging
  window.kiss = {
    clearAll: ()=>{
      if(confirm('Clear all local data?')){ entries = []; saveToStorage(); renderList(); clearForm(); }
    }
  };
})();
</script>
</body>
</html>
